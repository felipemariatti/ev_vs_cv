<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Comparador de Veículos</title>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            display: flex;
            justify-content: center;
            align-items: flex-start; /* Alinha no topo */
            min-height: 100vh;
            background-color: #e0e0f2; /* Cor de fundo mais clara */
            margin: 0;
            padding: 30px 20px; /* Mais padding para o topo */
            box-sizing: border-box;
        }
        .container {
            display: flex;
            gap: 30px; /* Aumenta o espaçamento entre os cards */
            width: 100%;
            max-width: 1000px; /* Ajusta a largura máxima */
            flex-wrap: wrap; /* Permite que os cards quebrem em telas menores */
            justify-content: center; /* Centraliza os cards */
        }
        .vehicle-section {
            background-color: white;
            padding: 25px;
            border-radius: 12px; /* Borda mais arredondada */
            box-shadow: 0 8px 20px rgba(100, 50, 200, 0.2); /* Sombra roxa mais pronunciada */
            width: 45%; /* Ajusta a largura para caber dois */
            min-width: 380px; /* Largura mínima para evitar quebras muito cedo */
            box-sizing: border-box;
            border: 1px solid #d0d0e0; /* Borda sutil */
            background-image: linear-gradient(to bottom, #ffffff, #fcfcff); /* Gradiente suave */
        }
        @media (max-width: 800px) { /* Para telas menores, os cards ficam em coluna */
            .vehicle-section {
                width: 90%;
            }
        }

        h2 {
            font-size: 1.5em;
            color: #4a4a4a;
            margin-top: 0;
            margin-bottom: 25px; /* Espaço maior abaixo do título */
            display: flex;
            align-items: center;
            gap: 10px;
            border-bottom: 1px solid #eee; /* Linha divisória abaixo do título */
            padding-bottom: 15px;
        }
        h2 i {
            font-size: 1.2em;
            color: #6a0dad; /* Cor roxa para os ícones */
        }

        .form-group {
            margin-bottom: 18px; /* Espaçamento entre grupos de campos */
        }
        .form-group label {
            display: block;
            font-size: 0.9em;
            color: #6a6a6a;
            margin-bottom: 5px;
            font-weight: 600;
        }
        select {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid #ccc;
            border-radius: 6px;
            margin-bottom: 20px; /* Espaço após o select */
            background-color: #f8f8f8;
            font-size: 1em;
            color: #333;
            -webkit-appearance: none; /* Remove seta padrão do Chrome/Safari */
            -moz-appearance: none;    /* Remove seta padrão do Firefox */
            appearance: none;         /* Remove seta padrão */
            background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%23000%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13.6-6.4H18.9c-5%200-9.6%202-13.6%206.4-4%204.4-6.4%209.6-6.4%2016.2s2.4%2011.8%206.4%2016.2l127.8%20127.9c4%204.4%209.2%206.4%2014.2%206.4s10.2-2%2014.2-6.4L287%20101.8c4-4.4%206.4-9.6%206.4-16.2-.1-6.6-2.5-11.8-6.5-16.2z%22%2F%3E%3C%2Fsvg%3E'); /* Seta customizada */
            background-repeat: no-repeat;
            background-position: right 10px top 50%;
            background-size: 12px auto;
        }
        select:focus {
            border-color: #6a0dad;
            outline: none;
            box-shadow: 0 0 0 3px rgba(106, 13, 173, 0.2);
        }

        .input-group {
            display: flex;
            align-items: center;
            gap: 8px; /* Espaçamento entre o input e o botão */
        }
        .input-group input[type="text"] {
            flex-grow: 1; /* O input ocupa o espaço restante */
            padding: 10px 12px;
            border: 1px solid #ccc;
            border-radius: 6px;
            background-color: #f8f8f8;
            font-size: 1em;
            color: #333;
            box-sizing: border-box;
            opacity: 0.9; /* Deixa um pouco mais claro quando desabilitado */
        }
        .input-group input[type="text"]:disabled {
            background-color: #f8f8f8; /* Fundo mais claro para desabilitado */
            color: #666;
            cursor: not-allowed;
        }
        .input-group input[type="text"]:focus:not(:disabled) {
            border-color: #6a0dad;
            outline: none;
            box-shadow: 0 0 0 3px rgba(106, 13, 173, 0.2);
            background-color: #fff; /* Fundo branco quando editável e focado */
            opacity: 1;
        }

        .edit-button {
            padding: 8px 12px;
            background-color: #e6ffe6; /* Verde claro */
            color: #28a745; /* Texto verde escuro */
            border: 1px solid #28a745; /* Borda verde */
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.85em;
            font-weight: 600;
            transition: background-color 0.2s, color 0.2s, border-color 0.2s;
            white-space: nowrap; /* Evita que o texto "Editável" quebre */
        }
        .edit-button:hover {
            background-color: #d4fcd4;
            border-color: #218838;
        }
        .edit-button.active { /* Estilo para quando o botão está ativo (editando) */
            background-color: #e0e0f2; /* Azul claro/roxo */
            color: #6a0dad; /* Roxo principal */
            border-color: #6a0dad;
        }

        /* Cores específicas para as caixas de texto com o valor inicial 0.00 */
        .initial-value-input {
            color: #008000; /* Verde para valores iniciais */
            font-weight: bold;
        }
    </style>
</head>
<body>

<div class="container">
    <div class="vehicle-section">
        <h2><i class="fas fa-battery-full"></i> Veículos Elétricos</h2>
        
        <div class="form-group">
            <label for="electric-models">Selecione um modelo:</label>
            <select id="electric-models" onchange="displayInfo('electric')">
                <option value="">Carregando modelos...</option>
            </select>
        </div>

        <div id="electric-info">
            <div class="form-group">
                <label for="electric-price">Preço Inicial (R$)</label>
                <div class="input-group">
                    <input type="text" id="electric-price" value="0.00" disabled class="initial-value-input">
                    <button class="edit-button" onclick="toggleEdit('electric-price', this)">Editável</button>
                </div>
            </div>
            
            <div class="form-group">
                <label for="electric-consumption">Consumo (km/kWh)</label>
                <input type="text" id="electric-consumption" value="-" disabled>
            </div>

            <div class="form-group">
                <label for="electric-cost-energy">Custo Energia (R$/kWh)</label>
                <div class="input-group">
                    <input type="text" id="electric-cost-energy" value="0.00" disabled class="initial-value-input">
                    <button class="edit-button" onclick="toggleEdit('electric-cost-energy', this)">Editável</button>
                </div>
            </div>
            
            <div class="form-group">
                <label for="electric-maintenance">Custo Manutenção Anual (R$)</label>
                <input type="text" id="electric-maintenance" value="-" disabled>
            </div>
            
            <div class="form-group">
                <label for="electric-autonomy">Autonomia (km)</label>
                <input type="text" id="electric-autonomy" value="-" disabled>
            </div>
            
            <div class="form-group">
                <label for="electric-lifespan">Vida Útil (anos)</label>
                <input type="text" id="electric-lifespan" value="-" disabled>
            </div>
        </div>
    </div>

    <div class="vehicle-section">
        <h2><i class="fas fa-gas-pump"></i> Veículos a Combustão</h2>
        
        <div class="form-group">
            <label for="combustion-models">Selecione um modelo:</label>
            <select id="combustion-models" onchange="displayInfo('combustion')">
                <option value="">Carregando modelos...</option>
            </select>
        </div>

        <div id="combustion-info">
            <div class="form-group">
                <label for="combustion-price">Preço Inicial (R$)</label>
                <div class="input-group">
                    <input type="text" id="combustion-price" value="0.00" disabled class="initial-value-input">
                    <button class="edit-button" onclick="toggleEdit('combustion-price', this)">Editável</button>
                </div>
            </div>
            
            <div class="form-group">
                <label for="combustion-consumption">Consumo (km/L)</label>
                <input type="text" id="combustion-consumption" value="-" disabled>
            </div>

            <div class="form-group">
                <label for="combustion-cost-fuel">Custo Combustível (R$/L)</label>
                <div class="input-group">
                    <input type="text" id="combustion-cost-fuel" value="0.00" disabled class="initial-value-input">
                    <button class="edit-button" onclick="toggleEdit('combustion-cost-fuel', this)">Editável</button>
                </div>
            </div>
            
            <div class="form-group">
                <label for="combustion-maintenance">Custo Manutenção Anual (R$)</label>
                <input type="text" id="combustion-maintenance" value="-" disabled>
            </div>
            
            <div class="form-group">
                <label for="combustion-autonomy">Autonomia (km)</label>
                <input type="text" id="combustion-autonomy" value="-" disabled>
            </div>
            
            <div class="form-group">
                <label for="combustion-lifespan">Vida Útil (anos)</label>
                <input type="text" id="combustion-lifespan" value="-" disabled>
            </div>
        </div>
    </div>
</div>

<script>
    const csvUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vTieSyzAPyQ1TQ_IfwWX3tjBfEkGFgROxgcg9RMsspK9OBIDxZSjyE1I6XW12fIDJqIlqxYpaDzJ4pS/pub?output=csv';
    let vehicleData = [];

    const electricModelsSelect = document.getElementById('electric-models');
    const combustionModelsSelect = document.getElementById('combustion-models');

    const electricPriceInput = document.getElementById('electric-price');
    const electricConsumptionInput = document.getElementById('electric-consumption');
    const electricCostEnergyInput = document.getElementById('electric-cost-energy');
    const electricMaintenanceInput = document.getElementById('electric-maintenance');
    const electricAutonomyInput = document.getElementById('electric-autonomy');
    const electricLifespanInput = document.getElementById('electric-lifespan');

    const combustionPriceInput = document.getElementById('combustion-price');
    const combustionConsumptionInput = document.getElementById('combustion-consumption');
    const combustionCostFuelInput = document.getElementById('combustion-cost-fuel');
    const combustionMaintenanceInput = document.getElementById('combustion-maintenance');
    const combustionAutonomyInput = document.getElementById('combustion-autonomy');
    const combustionLifespanInput = document.getElementById('combustion-lifespan');

    function loadCSVData() {
        Papa.parse(csvUrl, {
            download: true,
            header: true,
            dynamicTyping: true,
            skipEmptyLines: true,
            complete: function(results) {
                vehicleData = results.data;
                populateSelects(vehicleData);
            },
            error: function(error) {
                console.error("Erro ao carregar o CSV:", error);
                electricModelsSelect.innerHTML = '<option value="">Erro ao carregar dados</option>';
                combustionModelsSelect.innerHTML = '<option value="">Erro ao carregar dados</option>';
            }
        });
    }

    function populateSelects(data) {
        electricModelsSelect.innerHTML = '<option value="">Selecione um modelo...</option>';
        combustionModelsSelect.innerHTML = '<option value="">Selecione um modelo...</option>';

        data.forEach(vehicle => {
            const option = document.createElement('option');
            option.value = vehicle.Modelo;
            option.textContent = vehicle.Modelo;

            if (vehicle.Tipo === 'Elétrico') {
                electricModelsSelect.appendChild(option);
            } else if (vehicle.Tipo === 'Combustão') {
                combustionModelsSelect.appendChild(option);
            }
        });
    }

    // Função para formatar números para exibição
    function formatNumber(value, currency = false) {
        if (value === null || value === undefined || value === '') {
            return '-';
        }
        if (typeof value === 'number') {
            if (currency) {
                return value.toFixed(2).replace('.', ',');
            }
            return value.toString().replace('.', ',');
        }
        // Tenta converter se for string e contém números
        const num = parseFloat(String(value).replace(',', '.'));
        if (!isNaN(num)) {
            if (currency) {
                return num.toFixed(2).replace('.', ',');
            }
            return num.toString().replace('.', ',');
        }
        return String(value); // Retorna como string se não for número
    }


    function displayInfo(type) {
        let selectedModelName;
        let priceInput, consumptionInput, costEnergyFuelInput, maintenanceInput, autonomyInput, lifespanInput;

        if (type === 'electric') {
            selectedModelName = electricModelsSelect.value;
            priceInput = electricPriceInput;
            consumptionInput = electricConsumptionInput;
            costEnergyFuelInput = electricCostEnergyInput;
            maintenanceInput = electricMaintenanceInput;
            autonomyInput = electricAutonomyInput;
            lifespanInput = electricLifespanInput;
        } else {
            selectedModelName = combustionModelsSelect.value;
            priceInput = combustionPriceInput;
            consumptionInput = combustionConsumptionInput;
            costEnergyFuelInput = combustionCostFuelInput;
            maintenanceInput = combustionMaintenanceInput;
            autonomyInput = combustionAutonomyInput;
            lifespanInput = combustionLifespanInput;
        }

        const selectedVehicle = vehicleData.find(v => v.Modelo === selectedModelName);

        if (selectedVehicle) {
            priceInput.value = formatNumber(selectedVehicle['Preço Inicial (R$)'], true);
            
            // Assegura o texto correto para consumo
            if (type === 'electric') {
                consumptionInput.value = formatNumber(selectedVehicle['Consumo (km/kWh ou km/L)']);
                costEnergyFuelInput.value = formatNumber(selectedVehicle['Custo Energia/Combustível (R$/kWh ou R$/L)'], true);
            } else {
                consumptionInput.value = formatNumber(selectedVehicle['Consumo (km/kWh ou km/L)']); // O cabeçalho na planilha é o mesmo, mas a label no HTML é diferente
                costEnergyFuelInput.value = formatNumber(selectedVehicle['Custo Energia/Combustível (R$/kWh ou R$/L)'], true); // O cabeçalho na planilha é o mesmo, mas a label no HTML é diferente
            }
            
            maintenanceInput.value = formatNumber(selectedVehicle['Custo Manutenção Anual (R$)'], true);
            autonomyInput.value = formatNumber(selectedVehicle['Autonomia (km)']);
            lifespanInput.value = formatNumber(selectedVehicle['Vida Útil (anos)']);
        } else {
            // Limpa todos os campos se nenhum modelo for selecionado
            priceInput.value = '0.00';
            consumptionInput.value = '-';
            costEnergyFuelInput.value = '0.00';
            maintenanceInput.value = '-';
            autonomyInput.value = '-';
            lifespanInput.value = '-';

            // Garante que os campos editáveis voltem para disabled e o botão para "Editável"
            toggleEdit(priceInput.id, priceInput.nextElementSibling, false);
            toggleEdit(costEnergyFuelInput.id, costEnergyFuelInput.nextElementSibling, false);
        }
    }

    // Função para alternar o estado de edição
    function toggleEdit(inputId, buttonElement, forceState = undefined) {
        const input = document.getElementById(inputId);
        
        let shouldBeEditable;
        if (forceState !== undefined) {
            shouldBeEditable = forceState;
        } else {
            shouldBeEditable = input.disabled; // Se estiver disabled, queremos habilitar
        }

        input.disabled = !shouldBeEditable; // Inverte o estado
        
        if (shouldBeEditable) {
            buttonElement.textContent = 'Salvar'; // Ou outro texto, como "OK"
            buttonElement.classList.add('active');
            input.focus(); // Coloca o foco no input
            // Remove a classe de estilo inicial quando o campo se torna editável
            input.classList.remove('initial-value-input');
        } else {
            buttonElement.textContent = 'Editável';
            buttonElement.classList.remove('active');
            // Re-adiciona a classe de estilo inicial se o valor for 0.00
            if (input.value === '0.00') {
                 input.classList.add('initial-value-input');
            }
        }
    }

    document.addEventListener('DOMContentLoaded', loadCSVData);

</script>

</body>
</html>
